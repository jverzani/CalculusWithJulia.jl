<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>


<style>
.julia {display: block; font-family: "Source Code Pro";
        color:#0033CC;
        }
.hljl {font-family: "Source Code Pro";
        color:#0033CC;
      }
.output, .julia-error {
    border-left: thick solid #ff0000;
    padding: 5px;
    background-color: #f5f5f5;
}
body { padding-top: 60px; }
.output {color:#0033CC;}
h5:before {content:"\2746\ ";}
h6:before {content:"\2742\ ";}
pre {display: block;}
th, td {
  padding: 5px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}
tr:hover {background-color: #f5f5f5;}

.admonition-title:before {content:"\2746\ ";}
.admonition-title { color:#0033CC}


</style>

<!-- .julia:before {content: "julia> "} -->

<style></style>

<script src="https://code.jquery.com/jquery.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.3/dist/katex.min.css" integrity="sha384-ThssJ7YtjywV52Gj4JE/1SQEDoMEckXyhkFVwaf4nDSm5OBlXeedVYjuuUd0Yua+" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.3/dist/katex.min.js" integrity="sha384-Bi8OWqMXO1ta+a4EPkZv7bYGIes7C3krGSZoTGNTAnAn5eYQc7IIXrJ/7ck1drAi" crossorigin="anonymous"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.3/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.3/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
	onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true},
	      {left: "\\begin{equation}", right: "\\end{equation}", display: true},
              {left: "\\begin{align}", right: "\\end{align}", display: true},
	      {left: "\\begin{alignat}", right: "\\end{alignat}", display: true},
	      {left: "\\begin{gather}", right: "\\end{gather}", display: true}
          ],
          // • rendering keys, e.g.:
          throwOnError : false
        });
    });
</script>
<script>
window.PlotlyConfig = {MathJaxConfig: 'local'}
</script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<!-- highlight Julia Code -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.1/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.1/languages/julia.min.js"></script>

<script type="text/javascript">
$( document ).ready(function() {
  $("h1").each(function(index) {
       var title = $( this ).text()
       $("#page_title").html("<strong>" + title + "</strong>");
       document.title = title
  });
  $( "h2" ).each(function( index ) {
    var nm =  $( this ).text();
    var id = $.trim(nm).replace(/ /g,'');
    this.id = id
    $("#page_dropdown").append("<li><a class='dropdown-item' href='#" + id + "'>" + nm + "</a></li>");
  });
    $('[data-toggle="popover"]').popover();
});
</script>



</head>


<body data-spy="scroll" >

  <header class="navbar navbar-expand-md navbar-dark bd-navbar">
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top navbar-nav">
    <div class="container-fluid">

      <a class="navbar-brand" href="https://juliahub.com/docs/CalculusWithJulia/">Calculus with Julia</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <ul class="nav navbar-nav navbar-right">
      <li class="nav-item dropdown">
	<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown"
	   role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Jump to...
          </a>

        <ul class="dropdown-menu" aria-labelledby="navbarDropdown" role="menu" id="page_dropdown"></ul>
      </li>
    </ul>

    </div>
  </div>
</nav>

</header>
          <div class="title">
            
            
            
          </div>



<div class="container-fluid">
  <div class="span10 offset1">
    <h1>Numeric derivatives</h1>


<p><code>SymPy</code> returns symbolic derivatives. Up to choices of simplification, these answers match those that would be derived by hand. This is useful when comparing with known answers and for seeing the structure of the answer. However, there are times we just want to work with the answer numerically. For that we have other options.</p>
<h3>Approximate derivatives</h3>
<p>An approximate derivative can be used. By approximating the limit of the secant line with a value for a small, but positive, <span class="math">$h$</span>, we get an approximation. That is</p>
<p class="math">\[
~
f'(x) \approx \frac{f(x+h) - f(x)}{h}.
~
\]</p>
<p>This is the forward-difference approximation. The central difference approximation looks both ways:</p>
<p class="math">\[
~
f'(x) \approx \frac{f(x+h) - f(x-h)}{2h}.
~
\]</p>
<p>Though in general they are different, they are both approximations. The central difference is a bit more accurate for the same size <span class="math">$h$</span>. However, both are susceptible to round-off errors. The numerator is a subtraction of like-size numbers - a perfect opportunity to lose precision. As such there is a balancing act: if <span class="math">$h$</span> is too small the round-off errors are problematic, if <span class="math">$h$</span> is too big, the approximation to the limit is not good. For the forward difference <span class="math">$h$</span> values around <span class="math">$10^{-8}$</span> are good, for the central difference, values around <span class="math">$10^{-6}$</span> are good for most instances.</p>
<h5>Example</h5>
<p>Let&#39;s verify that the forward difference isn&#39;t too far off.</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>c</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
</span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1e-8</span><span class='hljl-t'>
</span><span class='hljl-n'>approx</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>h</span>
</pre>


<pre class="output">
-0.6065306479285937
</pre>


<p>We can compare to the actual with:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>CalculusWithJulia</span><span class='hljl-t'>
</span><span class='hljl-nd'>@syms</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-n'>df</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>diff</span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>actual</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>N</span><span class='hljl-p'>(</span><span class='hljl-nf'>df</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>actual</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>approx</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
1.1784039743341233922198211703441918135487186955682892158735056519413744332
99215e-08
</pre>


<p>The error is about 1 part in 100 million.</p>
<p>The central difference is better here:</p>


<pre class='hljl'>
<span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1e-6</span><span class='hljl-t'>
</span><span class='hljl-n'>approx</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>-</span><span class='hljl-n'>h</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>actual</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>approx</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
1.5675682314574593707716021679222822987186955682892158735056519413744332992
14873e-11
</pre>


<h3>Automatic derivatives</h3>
<p>There are some other ways to compute derivatives numerically that give much more accuracy at the expense of some increased computing time. Automatic differentiation is the general name for a few different approaches. These approaches promise less complexity - in some cases - than symbolic derivatives and more accuracy than approximate derivatives. In fact the accuracy is on the order of machine precision.</p>
<p>The <code>ForwardDiff</code> package provides one of several ways for <code>Julia</code> to compute automatic derivatives. This package is loaded with <code>CalculusWithJulia</code>, but its functions are not exported, so their usage requires qualification. To illustrate, to find the derivative of <span class="math">$f(x)$</span> at a <em>point</em> we have this syntax:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>c</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
</span><span class='hljl-n'>ForwardDiff</span><span class='hljl-oB'>.</span><span class='hljl-nf'>derivative</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>   </span><span class='hljl-cs'># derivative is qualified by a module name</span>
</pre>


<pre class="output">
-0.6065306597126334
</pre>


<p>The <code>CalculusWithJulia</code> package defines an operator <code>D</code> which goes from finding a derivative at a point with <code>ForwardDiff.derivative</code> to definin a function which evaluates the derivative at each point. It is defined along the lines of <code>D&#40;f&#41; &#61; x -&gt; ForwardDiff.derivative&#40;f,x&#41;</code> in parallel to how the derivative operation for a function is defined mathematically from the definition for its value at a point.</p>
<p>Here we see the error in estimating <span class="math">$f'(1)$</span> for the <span class="math">$f(x) = e^{-x^2/2}$</span>.</p>


<pre class='hljl'>
<span class='hljl-n'>approx</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>D</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>         </span><span class='hljl-cs'># D(f) is a function, D(f)(c) is the function called on c</span><span class='hljl-t'>
</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>actual</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>approx</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
6.5931784154914140329521870533312554431710784126494348058625566700785127332
95529e-19
</pre>


<p>In this case, it is exact.</p>
<p>The <code>D</code> operator is only defined for most functions, not all. &#40;The <code>diff</code> operator of <code>SymPy</code> is somewhat similar in that respect.&#41;</p>
<h5>Example</h5>
<p>For <span class="math">$f(x) = \sqrt{1 + \sin(\cos(x))}$</span> compare the difference between the forward derivative with <span class="math">$h=1e-8$</span> and that computed by <code>D</code> at <span class="math">$x=\pi/4$</span>.</p>
<p>The forward derivative is found from:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)))</span><span class='hljl-t'>
</span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>1e-8</span><span class='hljl-t'>
</span><span class='hljl-n'>fwd</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>))</span><span class='hljl-oB'>/</span><span class='hljl-n'>h</span>
</pre>


<pre class="output">
-0.20927346522370271
</pre>


<p>That given by <code>D</code> is:</p>


<pre class='hljl'>
<span class='hljl-n'>ds_value</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>D</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>)(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>ds_value</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fwd</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ds_value</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>fwd</span>
</pre>


<pre class="output">
&#40;-0.20927346371432803, -0.20927346522370271, 1.5093746807970376e-9&#41;
</pre>


<p>Finally, <code>SymPy</code> gives an exact value we use to compare:</p>


<pre class='hljl'>
<span class='hljl-nd'>@syms</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-n'>actual</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>diff</span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>subs</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>PI</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-t'>
</span><span class='hljl-n'>actual</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>ds_value</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>actual</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>fwd</span>
</pre>


<pre class="output">
&#40;-5.29413734954932810851790641707227270040811239385425461541883810861494031
49753e-17, 1.50937462785566413119613527120569001018547612091887606145745384
5811618913850597e-09&#41;
</pre>


<h4>Convenient notation</h4>
<p><code>Julia</code> allows the possibility of extending functions to different types. Out of the box, the <code>&#39;</code> notation is not employed for functions, but is used for matrices. It is used in postfix position, as with <code>A&#39;</code>. We can define it to do the same thing as <code>D</code> for functions and then, we can evaluate derivatives with the familiar <code>f&#39;&#40;x&#41;</code>. This is done in <code>CalculusWithJulia</code> along the lines of <code>Base.adjoint&#40;f::Function&#41; &#61; D&#40;f&#41;</code>.</p>
<p>Then, we have, for example:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>pi</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>pi</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;-1.0, -1.2246467991473532e-16&#41;
</pre>


<h5>Example</h5>
<p>Suppose our task is to find a zero of the second derivative of <span class="math">$f(x) = e^{-x^2/2}$</span> in <span class="math">$[0, 10]$</span>, a known bracket. The <code>D</code> function takes a second argument to indicate the order of the derivative &#40;e.g., <code>D&#40;f,2&#41;</code>&#41;, but we use the more familiar notation:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>fzero</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;&#39;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
1.0
</pre>


<p>We pass in the function object, <code>f&#39;&#39;</code>, and not the evaluated function.</p>
<h2>Recap on derivatives in Julia</h2>
<p>A quick summary for finding derivatives in <code>Julia</code>, as there are <span class="math">$3$</span> different manners:</p>
<ul>
<li><p>Symbolic derivatives are found using <code>diff</code> from <code>SymPy</code></p>
</li>
<li><p>Automatic derivatives are found using the notation <code>f&#39;</code> using <code>ForwardDiff.derivative</code></p>
</li>
<li><p>approximate derivatives at a point, <code>c</code>, for a given <code>h</code> are found with <code>&#40;f&#40;c&#43;h&#41;-f&#40;c&#41;&#41;/h</code>.</p>
</li>
</ul>
<p>For example</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>c</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-t'>
</span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.1</span><span class='hljl-t'>
</span><span class='hljl-nd'>@syms</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>

</span><span class='hljl-n'>fp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>diff</span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>fp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;-exp&#40;-x&#41;*sin&#40;x&#41; &#43; exp&#40;-x&#41;*cos&#40;x&#41;, -exp&#40;-pi&#41;&#41;
</pre>


<p>As compared to</p>


<pre class='hljl'>
<span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-oB'>-</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>))</span><span class='hljl-oB'>/</span><span class='hljl-n'>h</span>
</pre>


<pre class="output">
&#40;-0.043213918263772265, -0.03903643351818505&#41;
</pre>


<h2>Questions</h2>
<h5>Question</h5>
<p>Find the derivative using a forward difference approximation of <span class="math">$f(x) = x^x$</span> at the point <span class="math">$x=2$</span> using <code>h&#61;0.1</code>:</p>


<form name='WeaveQuestion' data-id='lgElKafk' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="lgElKafk" type="number" class="form-control">

</div>

<div id='lgElKafk_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#lgElKafk').on('change', function() {
  correct = Math.abs(this.value - 7.496380917422423) <= 0.001;

  if(correct) {
     $('#lgElKafk_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#lgElKafk_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<p>Using <code>D</code> or <code>f&#39;</code> find the value using automatic differentiation</p>


<form name='WeaveQuestion' data-id='ZZroLHa6' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="ZZroLHa6" type="number" class="form-control">

</div>

<div id='ZZroLHa6_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#ZZroLHa6').on('change', function() {
  correct = Math.abs(this.value - 6.772588722239782) <= 0.001;

  if(correct) {
     $('#ZZroLHa6_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#ZZroLHa6_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<h5>Question</h5>
<p>Mathematically, as the value of <code>h</code> in the forward difference gets smaller the forward difference approximation gets better. On the computer, this is thwarted by floating point representation issues &#40;in particular the error in subtracting two like-sized numbers in forming <span class="math">$f(x+h)-f(x)$</span>.&#41;</p>
<p>For <code>1e-16</code> what is the error &#40;in absolute value&#41; in finding the forward difference approximation for the derivative of <span class="math">$\sin(x)$</span> at <span class="math">$x=0$</span>?</p>


<form name='WeaveQuestion' data-id='f2J0lfuK' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="f2J0lfuK" type="number" class="form-control">

</div>

<div id='f2J0lfuK_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#f2J0lfuK').on('change', function() {
  correct = Math.abs(this.value - 37.637359812630166) <= 0.001;

  if(correct) {
     $('#f2J0lfuK_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#f2J0lfuK_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<p>Repeat for <span class="math">$x=pi/4$</span>:</p>


<form name='WeaveQuestion' data-id='d7VVjWc5' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="d7VVjWc5" type="number" class="form-control">

</div>

<div id='d7VVjWc5_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#d7VVjWc5').on('change', function() {
  correct = Math.abs(this.value - 1.0) <= 0.001;

  if(correct) {
     $('#d7VVjWc5_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#d7VVjWc5_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<h6>Question</h6>
<p>Let <span class="math">$f(x) = x^x$</span>. Using <code>D</code>, find <span class="math">$f'(3)$</span>.</p>


<form name='WeaveQuestion' data-id='Ia4hfQhj' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="Ia4hfQhj" type="number" class="form-control">

</div>

<div id='Ia4hfQhj_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#Ia4hfQhj').on('change', function() {
  correct = Math.abs(this.value - 56.66253179403897) <= 0.001;

  if(correct) {
     $('#Ia4hfQhj_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#Ia4hfQhj_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<h6>Question</h6>
<p>Let <span class="math">$f(x) = \lvert 1 - \sqrt{1 + x}\rvert$</span>. Using <code>D</code>, find <span class="math">$f'(3)$</span>.</p>


<form name='WeaveQuestion' data-id='yIoGXb5h' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="yIoGXb5h" type="number" class="form-control">

</div>

<div id='yIoGXb5h_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#yIoGXb5h').on('change', function() {
  correct = Math.abs(this.value - 0.25) <= 0.001;

  if(correct) {
     $('#yIoGXb5h_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#yIoGXb5h_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<h6>Question</h6>
<p>Let <span class="math">$f(x) = e^{\sin(x)}$</span>. Using <code>D</code>, find <span class="math">$f'(3)$</span>.</p>


<form name='WeaveQuestion' data-id='TusEAXq8' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="TusEAXq8" type="number" class="form-control">

</div>

<div id='TusEAXq8_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#TusEAXq8').on('change', function() {
  correct = Math.abs(this.value - -1.1400385675133151) <= 0.001;

  if(correct) {
     $('#TusEAXq8_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#TusEAXq8_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<h6>Question</h6>
<p>For <code>Julia</code>&#39;s <code>airyai</code> function find a numeric derivative using the forward difference. For <span class="math">$c=3$</span> and <span class="math">$h=10^{-8}$</span> find the forward difference approximation to <span class="math">$f'(3)$</span> for the <code>airyai</code> function.</p>


<form name='WeaveQuestion' data-id='cq7rm09Z' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="cq7rm09Z" type="number" class="form-control">

</div>

<div id='cq7rm09Z_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#cq7rm09Z').on('change', function() {
  correct = Math.abs(this.value - -0.011912976768252426) <= 0.001;

  if(correct) {
     $('#cq7rm09Z_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#cq7rm09Z_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<h6>Question</h6>
<p>Find the rate of change with respect to time of the function <span class="math">$f(t)= 64 - 16t^2$</span> at <span class="math">$t=1$</span>.</p>


<form name='WeaveQuestion' data-id='cFkrqgjh' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="cFkrqgjh" type="number" class="form-control">

</div>

<div id='cFkrqgjh_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#cFkrqgjh').on('change', function() {
  correct = Math.abs(this.value - -32) <= 0;

  if(correct) {
     $('#cFkrqgjh_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#cFkrqgjh_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


<h6>Question</h6>
<p>Find the rate of change with respect to height, <span class="math">$h$</span>, of <span class="math">$f(h) = 32h^3 - 62 h + 12$</span> at <span class="math">$h=2$</span>.</p>


<form name='WeaveQuestion' data-id='vNWEwDko' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="vNWEwDko" type="number" class="form-control">

</div>

<div id='vNWEwDko_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#vNWEwDko').on('change', function() {
  correct = Math.abs(this.value - 322) <= 0;

  if(correct) {
     $('#vNWEwDko_message').html('<div class="alert alert-success"><i class="bi bi-hand-thumbs-up-fill"></i>&nbsp;Correct</span></div>');
  } else {
     $('#vNWEwDko_message').html('<div class="alert alert-danger"><i class="bi bi-hand-thumbs-down-fill"></i>&nbsp;Incorrect</span></div>');
  }
});
</script>


  </div>
</div>

<script>
  document.querySelectorAll('pre.hljl').forEach(el => {   // first, find all the div.code blocks
  hljs.highlightElement(el);                              // then highlight each
  });

  var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'))
  var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
    return new bootstrap.Popover(popoverTriggerEl)
  });
</script>


</body>
</html>
